# 카오스 엔지니어링의 원칙

**카오스 엔지니어링** 이란 프로덕션 환경에서 각종 장애 조건들을 견딜 수 있는 시스템의 수용성을 구축하기 위해 분산 시스템을 실험하는 원칙들입니다.

대규모 분산 소프트웨어 시스템의 발전으로 인해, 소프트웨어 엔지니어링의 변화가 일어나고 있습니다. 업계에서는 발빠르게 개발의 유연성을 증가시키고 배포 속도를 올릴 수 있는 방법들을 적용하고 있습니다. 이러한 이면에 따라오는 질문이 있습니다: '우리는 프로덕션 환경의 복잡한 시스템에 대하여 얼마나 신뢰 할 수 있는가?' 하는 것입니다.

분산 시스템내의 모든 개별 적인 서비스들이 적절하게 동작하고 있더라고, 해당 서비스들 간의 상호 작용으로 인해 예측할 수 없는 결과를 야기할 수 있습니다. 프로덕션 환경에 영향을 미치는 드물지만 파괴적인 예측할 수 없는 결과들로 인해 분산 시스템을 본질적으로 'chaos' 상태로 만듭니다.

우리는 약점들이 시스템 전반적으로 나타나기 전에 식별해야 합니다. 시스템 약점들은 다음과 같은 형태를 띕니다: 서비스를 이용할 수 없을 때의 부적절한 대체 설정들, 부적절하게 조정된 타임아웃으로 인한 재시도 폭풍, 다운스트림 종속 서비스의 과도한 트래픽으로 인한 정지, 단일 장애 지점으로 인한 연쇄적인 장애들 등이 있다. 우리는 반드시 고객에게 이러한 약점들이 영향을 끼치기 전에 적극적으로 해결해야 합니다. 즉, 시스템이 가지고 있는 복잡성에도 불구하고 chaos를 본질적으로 관리하여  유연성과 속도를 증가 시키고 신뢰 할 수 있는 방법이 필요합니다.

경험적 시스템 기반의 접근법은 규모에 따른 분산 시스템의 chaos를 다루고 그러한 시스템의 현실적 조건을 견딜 수 있는 능력에 대한 신뢰를 구축한다. 우리는 통제된 환경에서 실험을 진행하고 관찰하며 분산 시스템의 행동에 대해 배울 수 있다. 우리는 이것을 **카오스 엔지니어링**이라고 부릅니다.

## 카오스 연습하기

분산 시스템의 불확실성을 구체적으로 해결하기 위해, **카오스 엔지니어링**은 시스템적인 약점을 발견하기 용이한 실험들이라고 생각할 수 있습니다. 이러한 실험들은 네 단계로 구성되어있습니다.

1. **정상 상태** 라는 정상 동작을 나타내는 측정할 수 있는 시스템의 결과들로 정의하기
2. **정상 상태** 가 대조군과 실험군 모두에서 계속 될 것이라고 가정하기
3. 크래시, 하드웨어 오작동, 단절된 네트워크 연결과 같은 실제 문제에 대한 변수 정의하기
4. 대조군과 실험 군 사이의 차이를 관찰하며 가설 검증하기

**정상 상태** 를 방해하기 어려울 수록, 시스템에 대한 신뢰를 더 가질 수 있습니다. 만약 약점이 발견되었다면, 시스템에서 그러한 동작이 일어나기 전에 개선 합니다.

## 고급 원칙

다음의 원칙들은 위에서 설명한 실험과정에서 적용 할 수 있는 **카오스 엔지니어링**에서의 이상적인 원칙들을 설명합니다. 이러한 원칙들이 추구되는 정도는 분산 시스템의 규모에 따른 신뢰도와 강하게 연관이 있습니다.

### 정상 상태 행동에 관한 가설 세우기

시스템의 내부 속성보단, 측정할 수 있는 결과에 집중합니다. 짧은 시간의 결과 측정을 통해 시스템의 **정상 상태**에 대해 정의합니다. 전체 시스템 처리량, 에러율, 대기 시간 비율 등이 **정상 상태** 동작을 나타낼 수 있는 지표들입니다. 실험 중에 시스템적인 동작 패턴에 집중함으로써, 시스템이 어떻게 작동하는 지에 대한 검증보다는 제대로 동작하는 지를 확인합니다.

### 실제 세계 문제 다양화하기

카오스 변수들은 실제 세계의 문제를 반영합니다. 문제들은 잠재적인 영향도나 예측된 빈도 수에 의해 우선순위화 합니다. 서버가 죽는 하드웨어 실패, 잘못된 응답을 하는 소프트웨어 실패와 트래픽 급증이나 스케일링 같은 비장애적인 문제들을 포함 할 수 있습니다. **정상 상태** 방해할 수 있는 어떠한 문제들도 **카오스 실험**에서 잠재적인 변수입니다.

### 실제 환경에서 실험하기

시스템들은 환경과 트래픽 패턴에 따라 다르게 동작합니다. 시스템 활용 빈도는 언제든지 변할 수 있으므로, 실제 트래픽을 샘플링하는것이 요청 경로를 파악하는 유일한 방법입니다. 시스템이 실행되는 방식의 확실성과 현재 배포된 시스템의 관련성을 보장하기 위해, 실제 환경에서 실험하는 것을 권장합니다.

### 지속적인 실행을 위한 실험 자동화

실험들을 수동으로 실행하는 것은 노동 집약적이고 궁극적으로 유지 불가능하다. 실험들을 자동화하고 지속적으로 실행해야합니다. **카오스 엔지니어링**은 인프라 오케스트레이션 및 데이터 분석을 위해 자동화 기능을 구현합니다.

### 폭발 반경 최소화

프로덕션 환경에서 실험을 하는 것은 고객에게 불필요한 문제를 야기할 수 있습니다. 단기간의 부정적인 영향에 대한 보장이 필요하지만, 실험에서 발생할 문제를 최소화하고 억제하는 것은 **카오스 엔지니어**의 궁극적인 책임과 의무입니다.

**카오스 엔지니어링**은 분산 시스템 환경에서 시스템적 불확실성을 검사하는 특별한 방법론입니다. **카오스 엔지니어링 원칙**은 대량 트래픽을 처리하는 서비스 규모에서 신속하게 서비스를 개선하고, 비정상적 상황에서도 고객에게 고품질의 서비스 경험을 제공할 자신감을 가질 수 있게 합니다.

*원글: http://principlesofchaos.org/*
